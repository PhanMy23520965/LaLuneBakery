<!DOCTYPE html>
<html>
<head>
    <title>La Lune Bakery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="/" style="font-weight: bold; color: var(--main-color); font-size: 1.5rem;">
                La Lune
            </a>
            
            <form class="d-flex mx-auto" action="/#menu" method="GET" style="width: 40%;">
                <input class="form-control me-2 rounded-pill" type="search" name="search" placeholder="Tìm tên bánh..." value="<%= search %>">
                <button class="btn btn-lune rounded-circle" type="submit"><i class="fas fa-search"></i></button>
            </form>

            <div>
                <% if(user) { %>
                    <div class="d-flex align-items-center">
                        <span class="me-3 d-none d-sm-inline-block" style="color: var(--text-color);">
                            Chào, <strong><%= user.fullname || "Khách hàng" %></strong>
                        </span>

                        <a href="/cart" class="btn btn-outline-danger me-2 position-relative">
                            <i class="fas fa-shopping-cart"></i>
                            <% if(user.cart && user.cart.length > 0) { %>
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                    <%= user.cart.length %>
                                </span>
                            <% } %>
                        </a>

                        <a href="/logout" class="btn btn-sm btn-outline-secondary" title="Đăng xuất">
                            <i class="fas fa-sign-out-alt"></i> Thoát
                        </a>
                    </div>
                <% } else { %>
                    <a href="/login" class="btn btn-lune">Đăng nhập</a>
                <% } %>
            </div>
        </div>
    </nav>

    <% if(locals.message) { %>
        <div class="container mt-3">
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="fas fa-check-circle me-2"></i> <%= message %>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        </div>
    <% } %>
    <div class="intro-section text-center py-5" style="background-color: #fdfbf7;">
        <div class="container">
            <div class="mb-3">
                <img src="/images/logo1.png" style="height: 200px; width: auto;" alt="La Lune Logo">
            </div>

            <h2 class="display-5" style="color: var(--main-color); font-family: 'Times New Roman', serif;">Câu chuyện La Lune</h2>
            <p class="lead mt-3 mx-auto" style="max-width: 700px; font-style: italic; color: #666;">
                "Giống như mặt trăng dịu dàng tỏa sáng giữa màn đêm, mỗi chiếc bánh tại La Lune được làm ra để xoa dịu tâm hồn bạn bằng sự ngọt ngào tinh tế nhất. Chúng tôi không chỉ bán bánh, chúng tôi gói ghém cảm xúc vào từng hương vị."
            </p>
            <hr class="my-4 mx-auto" style="width: 100px; border-top: 3px solid var(--main-color);">
        </div>
    </div>

    <div class="container mt-5 mb-5" id="menu">
        <h3 class="text-center mb-4" style="color: var(--text-color)">— Menu Món Ngon —</h3>
        
        <% if(products.length === 0) { %>
            <p class="text-center">Không tìm thấy bánh nào phù hợp :(</p>
        <% } %>

        <div class="row">
            <% products.forEach(function(cake) { %>
                <div class="col-md-4 col-sm-6 mb-4">
                    <div class="card card-custom h-100 product-card">
                        <a href="/product/<%= cake._id %>">
                            <div class="img-wrapper" style="height: 250px; overflow: hidden; border-radius: 15px 15px 0 0;">
                                <img src="<%= cake.image %>" class="card-img-top h-100 w-100" style="object-fit: cover;" alt="<%= cake.name %>">
                            </div>
                        </a>
                        <div class="card-body text-center">
                            <h5 class="card-title">
                                <a href="/product/<%= cake._id %>" style="text-decoration: none; color: var(--text-color)"><%= cake.name %></a>
                            </h5>
                            <p class="card-text fw-bold" style="color: var(--main-color)"><%= cake.price.toLocaleString('vi-VN') %> VNĐ</p>
                            <a href="/product/<%= cake._id %>" class="btn btn-sm btn-outline-secondary">Xem chi tiết</a>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
    <%- include('footer') %>
</body>
</html>